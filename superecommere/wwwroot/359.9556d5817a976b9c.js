"use strict";(self.webpackChunkSuperEcommere=self.webpackChunkSuperEcommere||[]).push([[359],{359:(W,b,m)=>{m.r(b),m.d(b,{AdminModule:()=>P});var l=m(4755),u=m(7179),e=m(9523),h=m(3144),c=m(2340),M=m(2037);let f=(()=>{class n{constructor(t,r){this.http=t,this.userServies=r,this.headers=new h.WM}getToken(){const t=this.userServies.getJWT();return this.headers.set("Authorization","Bearer "+t)}getMembers(){return this.http.get(`${c.N.appUrl}/admin/get-members`,{headers:this.getToken()})}getMember(t){return this.http.get(`${c.N.appUrl}/admin/get-member/${t}`,{headers:this.getToken()})}getApplicationRoles(){return this.http.get(`${c.N.appUrl}/admin/get-application-roles`,{headers:this.getToken()})}addEditMember(t){return this.http.post(`${c.N.appUrl}/admin/add-edit-member`,t,{headers:this.getToken()})}lockMember(t){return this.http.put(`${c.N.appUrl}/admin/lock-member/${t}`,{},{headers:this.getToken()})}unlockMember(t){return this.http.put(`${c.N.appUrl}/admin/unlock-member/${t}`,{},{headers:this.getToken()})}deleteMember(t){return this.http.delete(`${c.N.appUrl}/admin/delete-member/${t}`,{headers:this.getToken()})}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(h.eN),e.LFG(M.f))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var A=m(646),k=m(2488);function U(n,o){1&n&&(e.TgZ(0,"tr")(1,"td",8),e._uU(2,"No Members"),e.qZA()())}function q(n,o){1&n&&(e.TgZ(0,"span"),e._uU(1,", "),e.qZA())}function C(n,o){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.YNc(2,q,2,0,"span",5),e.qZA()),2&n){const t=o.$implicit,r=o.index,i=e.oxw().$implicit;e.xp6(1),e.hij(" ",t,""),e.xp6(1),e.Q6J("ngIf",r+1<i.roles.length)}}function w(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"a",13),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,a=e.oxw();return e.KtG(a.lockMember(i.id))}),e._uU(1," Lock "),e.qZA()}}function F(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"a",14),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,a=e.oxw();return e.KtG(a.unlockMember(i.id))}),e._uU(1," Unlock "),e.qZA()}}function I(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.ALo(5,"titlecase"),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.ALo(8,"titlecase"),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.ALo(11,"date"),e.qZA(),e.TgZ(12,"td"),e.YNc(13,C,3,2,"span",6),e.qZA(),e.TgZ(14,"td",4),e.YNc(15,w,2,0,"a",9),e.YNc(16,F,2,0,"a",10),e.qZA(),e.TgZ(17,"td",4)(18,"button",11),e._uU(19," Edit "),e.qZA(),e.TgZ(20,"button",12),e.NdJ("click",function(){const a=e.CHM(t).$implicit,d=e.oxw(),p=e.MAs(24);return e.KtG(d.deleteMember(a.id,p))}),e._uU(21," Delete "),e.qZA()()()}if(2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t.userName),e.xp6(2),e.Oqu(e.lcZ(5,8,t.firstName)),e.xp6(3),e.Oqu(e.lcZ(8,10,t.lastName)),e.xp6(3),e.Oqu(e.lcZ(11,12,t.dateCreated)),e.xp6(3),e.Q6J("ngForOf",t.roles),e.xp6(2),e.Q6J("ngIf",!t.isLocked),e.xp6(1),e.Q6J("ngIf",t.isLocked),e.xp6(2),e.MGl("routerLink","/admin/add-edit-member/",t.id,"")}}function y(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",15)(1,"p"),e._uU(2),e.qZA(),e.TgZ(3,"button",16),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.confirm())}),e._uU(4,"Yes"),e.qZA(),e.TgZ(5,"button",17),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.decline())}),e._uU(6,"No"),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(2),e.hij("Are you sure you want to delete ",null==t.memberToDelete?null:t.memberToDelete.userName,"?")}}let E=(()=>{class n{constructor(t,r,i){this.adminService=t,this.sharedService=r,this.modalService=i,this.members=[]}ngOnInit(){this.adminService.getMembers().subscribe({next:t=>this.members=t})}lockMember(t){this.adminService.lockMember(t).subscribe({next:r=>{this.handleLockUnlockFilterAndMessage(t,!0)}})}unlockMember(t){this.adminService.unlockMember(t).subscribe({next:r=>{this.handleLockUnlockFilterAndMessage(t,!1)}})}deleteMember(t,r){let i=this.findMember(t);i&&(this.memberToDelete=i,this.modalRef=this.modalService.show(r,{class:"modal-sm"}))}confirm(){this.memberToDelete&&this.adminService.deleteMember(this.memberToDelete.id).subscribe({next:t=>{this.sharedService.showNotification(!0,"Deleted",`${this.memberToDelete?.userName} has been deleted`),this.members=this.members.filter(r=>r.id!==this.memberToDelete?.id),this.memberToDelete=void 0,this.modalRef?.hide()}})}decline(){this.memberToDelete=void 0,this.modalRef?.hide()}handleLockUnlockFilterAndMessage(t,r){let i=this.findMember(t);i&&(i.isLocked=!i.isLocked),r?this.sharedService.showNotification(!0,"Locked",`${i?.userName} member has been locked`):this.sharedService.showNotification(!0,"Unlocked",`${i?.userName} member has been unlocked`)}findMember(t){let r=this.members.find(i=>i.id===t);if(r)return r}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(f),e.Y36(A.F),e.Y36(k.tT))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-admin-home"]],decls:25,vars:2,consts:[[1,"my-3"],["routerLink","/admin/add-edit-member",1,"btn","btn-outline-primary"],[1,"table","table-striped"],[1,"table-warning"],[1,"text-center"],[4,"ngIf"],[4,"ngFor","ngForOf"],["template",""],["colspan","/",1,"text-center"],["class","btn btn-warning btn-sm",3,"click",4,"ngIf"],["class","btn btn-success btn-sm",3,"click",4,"ngIf"],[1,"btn","btn-primary","btn-sm","me-2",3,"routerLink"],[1,"btn","btn-danger","btn-sm","me-2",3,"click"],[1,"btn","btn-warning","btn-sm",3,"click"],[1,"btn","btn-success","btn-sm",3,"click"],[1,"modal-body","text-center"],["type","button",1,"btn","btn-default",3,"click"],["type","button",1,"btn","btn-primary",3,"click"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0)(1,"a",1),e._uU(2,"create Member"),e.qZA()(),e.TgZ(3,"table",2)(4,"thead")(5,"tr",3)(6,"th"),e._uU(7,"Username"),e.qZA(),e.TgZ(8,"th"),e._uU(9,"First Name"),e.qZA(),e.TgZ(10,"th"),e._uU(11,"Last Name"),e.qZA(),e.TgZ(12,"th"),e._uU(13,"Date Created"),e.qZA(),e.TgZ(14,"th"),e._uU(15,"Roles"),e.qZA(),e.TgZ(16,"th",4),e._uU(17,"Lock / Unlock"),e.qZA(),e.TgZ(18,"th",4),e._uU(19,"Edit / Delete"),e.qZA()()(),e.TgZ(20,"tbody"),e.YNc(21,U,3,0,"tr",5),e.YNc(22,I,22,14,"tr",6),e.qZA()(),e.YNc(23,y,7,1,"ng-template",null,7,e.W1O)),2&t&&(e.xp6(21),e.Q6J("ngIf",0===r.members.length),e.xp6(1),e.Q6J("ngForOf",r.members))},dependencies:[l.sg,l.O5,u.rH,l.rS,l.uU]}),n})();var g=m(437),s=m(5030),J=m(8860);function S(n,o){1&n&&(e.TgZ(0,"span",31),e._uU(1,"Add"),e.qZA())}function Y(n,o){1&n&&(e.TgZ(0,"span",31),e._uU(1,"Update"),e.qZA())}function L(n,o){1&n&&(e.TgZ(0,"span",32),e._uU(1," First Name is required "),e.qZA())}function H(n,o){1&n&&(e.TgZ(0,"span",32),e._uU(1," Last Name is required "),e.qZA())}function Q(n,o){1&n&&(e.TgZ(0,"span",32),e._uU(1," User Name is required "),e.qZA())}function $(n,o){1&n&&(e.TgZ(0,"span",32),e._uU(1," Password is required "),e.qZA())}function R(n,o){1&n&&(e.TgZ(0,"span",32),e._uU(1," password must be at least 6 ,and maximum 15 characters "),e.qZA())}function O(n,o){1&n&&(e.TgZ(0,"div")(1,"span",33),e._uU(2,"Note:"),e.qZA(),e._uU(3," if you don't intend to change the member password,then leave the password field empty "),e.qZA())}function G(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"input",34),e.NdJ("change",function(){const a=e.CHM(t).$implicit,d=e.oxw(2);return e.KtG(d.roleOnChange(a))}),e.qZA(),e.TgZ(2,"label",35),e._uU(3),e.qZA(),e.BQk()}if(2&n){const t=o.$implicit,r=e.oxw(2);let i;e.xp6(1),e.ekj("is-invalid",r.submitted&&(null==(i=r.memberForm.get("roles"))?null:i.errors)),e.s9C("id",t),e.Q6J("checked",r.existingMemberRoles.includes(t)),e.xp6(1),e.s9C("for",t),e.xp6(1),e.Oqu(t)}}function j(n,o){1&n&&(e.TgZ(0,"div",32),e._uU(1," Please select a leadt one role "),e.qZA())}function D(n,o){if(1&n&&(e.TgZ(0,"div",36),e._UZ(1,"app-validation-messages",37),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("errorMessages",t.errorMessages)}}function z(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",2)(2,"main",3)(3,"form",4),e.NdJ("ngSubmit",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.submit())}),e.TgZ(4,"div",5)(5,"h3",6),e.YNc(6,S,2,0,"span",7),e.YNc(7,Y,2,0,"span",7),e._uU(8," Member "),e.qZA()(),e.TgZ(9,"div",8),e._UZ(10,"input",9),e.TgZ(11,"label",10),e._uU(12,"First Name"),e.qZA(),e.YNc(13,L,2,0,"span",11),e.qZA(),e.TgZ(14,"div",8),e._UZ(15,"input",12),e.TgZ(16,"label",13),e._uU(17,"Last Name"),e.qZA(),e.YNc(18,H,2,0,"span",11),e.qZA(),e.TgZ(19,"div",8),e._UZ(20,"input",14),e.TgZ(21,"label",15),e._uU(22,"UserName"),e.qZA(),e.YNc(23,Q,2,0,"span",11),e.qZA(),e.TgZ(24,"div",8)(25,"input",16),e.NdJ("change",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.passwordOnChange())}),e.qZA(),e.TgZ(26,"label",17),e._uU(27,"Password"),e.qZA(),e.YNc(28,$,2,0,"span",11),e.YNc(29,R,2,0,"span",11),e.YNc(30,O,4,0,"div",18),e.qZA(),e.TgZ(31,"div",19)(32,"div",20)(33,"label",21),e._uU(34,"Roles:"),e.qZA()(),e.TgZ(35,"div",22)(36,"div",23),e.YNc(37,G,4,6,"ng-container",24),e.qZA()()(),e.YNc(38,j,2,0,"div",11),e.YNc(39,D,2,1,"div",25),e.TgZ(40,"div",26)(41,"div",27)(42,"div",28)(43,"button",29),e._uU(44),e.qZA()()(),e.TgZ(45,"div",27)(46,"div",28)(47,"button",30),e._uU(48," Back to list "),e.qZA()()()()()()()()}if(2&n){const t=e.oxw();let r,i,a,d,p,Z,v,T,_,N;e.xp6(3),e.Q6J("formGroup",t.memberForm),e.xp6(3),e.Q6J("ngIf",t.addNew),e.xp6(1),e.Q6J("ngIf",t.addNew),e.xp6(3),e.ekj("is-invalid",t.submitted&&(null==(r=t.memberForm.get("firstName"))?null:r.errors)),e.xp6(3),e.Q6J("ngIf",t.submitted&&(null==(i=t.memberForm.get("firstName"))?null:i.hasError("required"))),e.xp6(2),e.ekj("is-invalid",t.submitted&&(null==(a=t.memberForm.get("lastName"))?null:a.errors)),e.xp6(3),e.Q6J("ngIf",t.submitted&&(null==(d=t.memberForm.get("lastName"))?null:d.hasError("required"))),e.xp6(2),e.ekj("is-invalid",t.submitted&&(null==(p=t.memberForm.get("userName"))?null:p.errors)),e.xp6(3),e.Q6J("ngIf",t.submitted&&(null==(Z=t.memberForm.get("userName"))?null:Z.hasError("required"))),e.xp6(2),e.ekj("is-invalid",t.submitted&&(null==(v=t.memberForm.get("password"))?null:v.errors)),e.xp6(3),e.Q6J("ngIf",t.submitted&&(null==(T=t.memberForm.get("password"))?null:T.hasError("required"))),e.xp6(1),e.Q6J("ngIf",t.submitted&&(null==(_=t.memberForm.get("password"))?null:_.hasError("minlength"))||(null==(_=t.memberForm.get("password"))?null:_.hasError("maxlength"))),e.xp6(1),e.Q6J("ngIf",!t.addNew),e.xp6(7),e.Q6J("ngForOf",t.applicationRoles),e.xp6(1),e.Q6J("ngIf",t.submitted&&(null==(N=t.memberForm.get("roles"))?null:N.hasError("required"))),e.xp6(1),e.Q6J("ngIf",t.errorMessages.length>0),e.xp6(5),e.hij(" ",t.addNew?"Create":"Update"," Member ")}}let x=(()=>{class n{constructor(t,r,i,a,d){this.adminService=t,this.sharedService=r,this.formBuilder=i,this.router=a,this.activedRoute=d,this.memberForm=new s.cw({}),this.formInitialized=!1,this.addNew=!0,this.submitted=!1,this.errorMessages=[],this.applicationRoles=[],this.existingMemberRoles=[]}ngOnInit(){const t=this.activedRoute.snapshot.paramMap.get("id");t?(this.addNew=!1,this.getMember(t)):this.initializeForm(void 0),this.getRoles()}getMember(t){this.adminService.getMember(t).subscribe({next:r=>{this.initializeForm(r)}})}getRoles(){this.adminService.getApplicationRoles().subscribe({next:t=>this.applicationRoles=t})}initializeForm(t){t?(this.memberForm=this.formBuilder.group({id:[t.id],firstName:[t.firstName,s.kI.required],lastName:[t.lastName,s.kI.required],userName:[t.userName,s.kI.required],password:[""],roles:[t.roles,s.kI.required]}),this.existingMemberRoles=t.roles.split(",")):this.memberForm=this.formBuilder.group({id:[""],firstName:["",s.kI.required],lastName:["",s.kI.required],userName:["",s.kI.required],password:["",[s.kI.required,s.kI.minLength(6),s.kI.maxLength(15)]],roles:["",s.kI.required]}),this.formInitialized=!0}passwordOnChange(){0==this.addNew&&(this.memberForm.get("password")?.value?this.memberForm.controls.password.setValidators([s.kI.required,s.kI.minLength(6),s.kI.maxLength(15)]):this.memberForm.get("password")?.clearValidators(),this.memberForm.controls.password.updateValueAndValidity())}roleOnChange(t){let r=this.memberForm.get("roles")?.value.split(",");const i=r.indexOf(t);-1!=i?r.splice(i,1):r.push(t),""===r[0]&&r.splice(0,1),this.memberForm.controls.roles.setValue(r.join(","))}submit(){this.submitted=!0,this.errorMessages=[],this.memberForm.valid&&this.adminService.addEditMember(this.memberForm.value).subscribe({next:t=>{this.sharedService.showNotification(!0,t.value.title,t.value.message),this.router.navigateByUrl("/admin")},error:t=>{t.error.errors?this.errorMessages=t.error.errors:this.errorMessages.push(t.error)}})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(f),e.Y36(A.F),e.Y36(s.qu),e.Y36(u.F0),e.Y36(u.gz))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-add-edit-member"]],decls:1,vars:1,consts:[["class","d-flex justify-content-center",4,"ngIf"],[1,"d-flex","justify-content-center"],[1,"col-12","col-lg-5"],[1,"form-signin"],["autocomplete","off",3,"formGroup","ngSubmit"],[1,"text-center","mb-4"],[1,"hb-3","font-weight-normal"],["class","text-warning",4,"ngIf"],[1,"form-floating","mb-3"],["formControlName","firstName","type","text","placeholder","First Name",1,"form-control"],["for","firstName"],["class","text-danger",4,"ngIf"],["formControlName","lastName","type","text","placeholder","Last Name",1,"form-control"],["for","lastName"],["formControlName","userName","type","text","placeholder","User Name",1,"form-control"],["for","userName"],["formControlName","password","type","text","placeholder","Password",1,"form-control",3,"change"],["for","password"],[4,"ngIf"],[1,"row"],[1,"col-2"],["for","roles"],[1,"col-10"],[1,"btn-group"],[4,"ngFor","ngForOf"],["class","form-floatin",4,"ngIf"],[1,"row","my-4"],[1,"col-6"],[1,"d-grid"],["type","submit",1,"btn","btn-block","btn-info"],["type","button","routerLink","/admin",1,"btn","btn-block","btn-danger"],[1,"text-warning"],[1,"text-danger"],[1,"text-info","fw-bold"],["type","checkbox",1,"btn-check",3,"id","checked","change"],[1,"btn","btn-outline-primary",3,"for"],[1,"form-floatin"],[3,"errorMessages"]],template:function(t,r){1&t&&e.YNc(0,z,49,21,"div",0),2&t&&e.Q6J("ngIf",r.formInitialized)},dependencies:[l.sg,l.O5,u.rH,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,J.s]}),n})();const B=[{path:"",runGuardsAndResolvers:"always",canActivate:[g.u],component:E},{path:"add-edit-member",runGuardsAndResolvers:"always",canActivate:[g.u],component:x},{path:"add-edit-member/:id",runGuardsAndResolvers:"always",canActivate:[g.u],component:x}];let K=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[u.Bz.forChild(B),u.Bz]}),n})();var V=m(4466);let P=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[l.ez,K,V.m]}),n})()}}]);